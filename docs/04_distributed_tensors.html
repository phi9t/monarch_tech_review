<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>04_distributed_tensors.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>04 distributed tensors</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/index-CD6Gw4UH.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-Dcqqg9UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-sMh6mJ2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-Btv5Rh1v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-bBwmhqty.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-CoCQUAeM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cells-DPp5cDaO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/textarea-CRI7xDBj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/switch-dWLWbbtg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/mode-Bn7pdJvO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/ai-model-dropdown-Dk2SdB3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cell-link-B9b7J8QK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/datasource-CtyqtITR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/state-D4T75eZb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/MarimoErrorOutput-Lf9P8Fhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/html-to-image-CIQqSu-S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/focus-C1YokgL7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/LazyAnyLanguageCodeMirror-DgZ8iknE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/markdown-renderer-DJy8ww5d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/command-2ElA5IkO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/download-os8QlW6l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useRunCells-D2HBb4DB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/RenderHTML-D-of_-s7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/JsonOutput-PE5ko4gi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDeleteCell-DdRX94yC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/process-output-ByfLnk6j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/esm-Bmu2DhPy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/add-cell-with-ai-e_HMl7UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chat-display--jAB7huF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/column-preview-CXjSXUhP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/globals-BgACvYmr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/utilities.esm-dm9SQStE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/floating-outline-BtdqbkUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useAddCell-CmuX2hOk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/readonly-python-code-WjTf6Pdd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/types-BRfQN3HL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/form-BidPUZUn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/index-CeUwN_0i.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "04_distributed_tensors.py",
            "mode": "read",
            "version": "0.19.9",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Distributed Tensors in Monarch\n\nMonarch can broadcast tensor compute to a mesh of processes, allowing a single\ncontroller to do distributed tensor compute.\n\"\"\")", "code_hash": "8ead86caece2e18d877e58f1f6b3dfc6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "import monarch\nimport torch\nimport torch.nn as nn\nfrom monarch.actor import this_host\n\ntorch.set_default_device(\"cuda\")", "code_hash": "d541e3ffa6d179a99f56a9c9e99ec0e6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Meshes\n\nAll computation is done on a 'mesh' of devices.\nHere we create a mesh composed of the machine running the notebook:\n\"\"\")", "code_hash": "3012a77179fbdb1bd7e05395cdaee1b2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mesh = this_host().spawn_procs({\"gpu\": 8})\nprint(mesh.to_table())", "code_hash": "f0fe41e36cb0b07f301684983b10c8c8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"\nWithout a mesh active, torch runs locally.\n\"\"\")", "code_hash": "91661160d49578481a5334876da42e94", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "torch.rand(3, 4)", "code_hash": "72c528bae826df2239243aca7f068997", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(r\"\"\"\nOnce active, torch runs on every device in the mesh.\n\"\"\")", "code_hash": "0f25a61710bde87208074dbd5096d93d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "with mesh.activate():\n    t = torch.rand(3, 4, device=\"cuda\")\nt", "code_hash": "efa24e9e15b30ba5057cef1653c75c10", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "mo.md(r\"\"\"\n`inspect` moves rank 0's copy of `t` to the notebook for debugging.\nProviding coordinates lets us inspect other ranks' copies.\n\"\"\")", "code_hash": "a91a5a352b0a334c8f9385ce871e341a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "monarch.inspect(t)\nmonarch.show(t)\nmonarch.show(t, gpu=1)", "code_hash": "9703181d0bb0ead7af3d515b8a75406d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Tensor Commands\n\nAny command done on the controller, such as multiplying these tensors,\nperforms that action to all of the tensors in the collection.\n\"\"\")", "code_hash": "fcffb5dcbee2fe1fe34cba6a57265e98", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "with mesh.activate():\n    obj = t @ t.T\n    monarch.show(obj)", "code_hash": "36566cf6a12e7ef850c4166b0c61b88d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "mo.md(r\"\"\"\nIf a command fails, the workers stay alive and can execute future commands:\n\"\"\")", "code_hash": "cc549c8cf3c683ff986aa74185136386", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "try:\n    with mesh.activate():\n        big_w = torch.rand(4, 1024 * 1024 * 1024 * 1024 * 8, device=\"cuda\")\n        v = t @ big_w\n        monarch.show(v)\nexcept Exception:\n    import traceback\n    traceback.print_exc()\n\nprint(\"RECOVERED!\")", "code_hash": "d721b5caf6fc0bf1e6512ce258771c44", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "mo.md(r\"\"\"\nSince monarch recovers from errors, you can search for what works:\n\"\"\")", "code_hash": "53a2585a17fdad241e934ceb8a92a0ac", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "N = 1\nwhile True:\n    try:\n        with mesh.activate():\n            batch = torch.rand(N, 1024 * 1024 * 1024, device=\"cuda\")\n        monarch.inspect(batch.sum())\n        N = 2 * N\n        print(f\"at least 2**{N} elements work\")\n    except Exception:\n        print(f\"max is 2**{N} elements\")\n        break", "code_hash": "176adf2396ef926460999029fabe70e3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Collectives\n\nEach machine has its own copy of the tensor, similar to `torch.distributed`.\n\nTo compute across tensors in the mesh, we use special communication operators,\nanalogous to collectives.\n\"\"\")", "code_hash": "1cc424a5f3a12ead4fd8e9a71f538248", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "with mesh.activate():\n    a = torch.rand(3, 4, device=\"cuda\")\n    r = a.reduce(\"gpu\", \"sum\")\n\nmonarch.show(a, gpu=0)\nmonarch.show(a, gpu=1)\n\nmonarch.show(r, gpu=0)\nmonarch.show(r, gpu=1)", "code_hash": "a50d5ba6cef8f0ac36c8d71012f8b5da", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Remote GPUs\n\nWe can also connect to remote GPUs reserved from some scheduler.\nHere we simulate a multi-host setup locally:\n\"\"\")", "code_hash": "ca856f2f5ee511823b8ae678cd2cad50", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "remote_mesh = this_host().spawn_procs({\"host\": 4, \"gpu\": 4})\n\nprint(remote_mesh.to_table())\nwith remote_mesh.activate():\n    eg = torch.rand(3, 4, device=\"cuda\")\n    rgpu = eg.reduce(\"gpu\", \"sum\")\n    rhost = eg.reduce(\"host\", \"sum\")", "code_hash": "af97a927435bd43bf5ce926c57f42b8e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Device Mesh Dimensions\n\nMeshes can be renamed and reshaped to fit the parallelism desired.\n\"\"\")", "code_hash": "221d093b3b0728ace466889809bd5903", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "mesh_2d_parallel = remote_mesh.rename(host=\"dp\", gpu=\"tp\")\nprint(mesh_2d_parallel.to_table())\n\nmesh_3d_parallel = remote_mesh.split(host=(\"dp\", \"pp\"), gpu=(\"tp\",), pp=2)\nprint(mesh_3d_parallel.to_table())", "code_hash": "f4e5b8f0fec008a9c38a8d16ce6ab461", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Pipelining\n\nPipelining is accomplished by slicing the mesh, and copying tensors from\none mesh to another.\n\"\"\")", "code_hash": "06909103b6e9c76199caffc3f4910921", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "pipeline_mesh = remote_mesh.rename(host=\"pp\")\nmeshes = [pipeline_mesh.slice(pp=i) for i in range(pipeline_mesh.size(\"pp\"))]\nprint(meshes[0].to_table())", "code_hash": "7d49cade3de6e2dfc6502ba520d0cadd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "mo.md(r\"\"\"\nInitialize a model across multiple pipeline stages:\n\"\"\")", "code_hash": "4478979a0208e4c0c82e64dca71e03be", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "layers_per_stage = 2\nstages = []\nfor stage_mesh in meshes:\n    with stage_mesh.activate():\n        layers = []\n        for _ in range(layers_per_stage):\n            layers.extend([nn.Linear(4, 4), nn.ReLU()])\n        stages.append(nn.Sequential(*layers))\n\ndef forward_pipeline(x):\n    with torch.no_grad():\n        for stage_mesh, stage in zip(meshes, stages):\n            x = x.to_mesh(stage_mesh)\n            with stage_mesh.activate():\n                x = stage(x)\n        return x\n\nwith meshes[0].activate():\n    input = torch.rand(3, 4, device=\"cuda\")\n\noutput = forward_pipeline(input)\nmonarch.show(output)\nprint(output.mesh.to_table())", "code_hash": "97c39cdf4f6a0851ad32cbbf8b4e1801", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "mo.md(r\"\"\"\n## DDP Example\n\nThe next sections use an example of writing DDP to illustrate a typical way to\ndevelop code in Monarch.\n\nWe interleave the backward pass with the gradient reductions and parameter updates.\n`monarch.grad_generator` incrementally runs the backward pass, returning an iterator\nthat computes the grad parameters one at a time.\n\"\"\")", "code_hash": "c7424d07b8789ab496b972e5bb8f24c8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "def train(model, input, target):\n    loss = model(input, target)\n    rparameters = list(reversed(list(model.parameters())))\n    grads = monarch.grad_generator(loss, rparameters)\n    with torch.no_grad():\n        it = iter(zip(rparameters, grads))\n        todo = next(it, None)\n        while todo is not None:\n            param, grad = todo\n            grad.reduce_(\"dp\", \"sum\")\n            todo = next(it, None)\n            param += 0.01 * grad", "code_hash": "812b78f0d4ed08eee1f7d86cdcfd1077", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Simulation\n\nWe can use a simulator to check for expected behavior of code before running it\nfor real. It is another kind of mesh, which simulates rather than computes results.\n\"\"\")", "code_hash": "43c829a81ec2f100f41455f7eca01171", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Overlapping Comms/Compute\n\nCommands on different devices run in parallel, but by default commands on a single\ndevice run sequentially.\n\nWe introduce parallelism on a device via stream objects. To use a tensor from one\nstream on another we borrow it. The borrow API ensures deterministic memory usage\nand eliminates the race conditions in the `torch.cuda.stream` API.\n\"\"\")", "code_hash": "787fa7e9ae5a7dfa2db755f3ce7d2472", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "NCOB", "name": "_"}, {"code": "main = monarch.get_active_stream()\ncomms = monarch.Stream(\"comms\")", "code_hash": "378f76c1b006c37d46b675347c38c3b4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe DDP example again, but using multiple streams:\n\n---\n\n**Previous:** [NB03 \u2014 Fault Tolerance](./03_fault_tolerance.html) \u00b7 **Next:** [NB05 \u2014 RL Intro](./05_rl_intro.html)\n\"\"\")", "code_hash": "2ee3b3b50e459c2bfccabb45066464f9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TRpd", "name": "_"}, {"code": "class Net(nn.Module):\n    def __init__(self):\n        super().__init__()\n        layers = []\n        for x in range(8):\n            layers.append(nn.Linear(4, 4))\n            layers.append(nn.ReLU())\n        self.layers = nn.Sequential(*layers)\n\n    def forward(self, input, target):\n        output = self.layers(input)\n        return torch.nn.functional.cross_entropy(output, target)\n\ndef train2(model, input, target):\n    loss = model(input, target)\n    rparameters = list(reversed(list(model.parameters())))\n    grads = monarch.grad_generator(loss, rparameters)\n    with torch.no_grad():\n        # NEW: iter also produces the tensor borrowed\n        # to the comm stream\n        it = iter(\n            (param, grad, *comms.borrow(grad, mutable=True))\n            for param, grad in zip(rparameters, grads)\n        )\n\n        todo = next(it, None)\n        while todo is not None:\n            param, grad, comm_grad, borrow = todo\n            # NEW: compute the reduce on the comm stream\n            with comms.activate():\n                comm_grad.reduce_(\"dp\", \"sum\")\n            borrow.drop()\n            todo = next(it, None)\n            param += 0.01 * grad\n\n\n\ndef simulate():\n    simulator = monarch.Simulator(hosts=1, gpus=4, trace_mode=\"stream_only\")\n    mesh = simulator.mesh.rename(gpu=\"dp\")\n    with mesh.activate():\n        model = Net()\n\n        train2(model, torch.rand(3, 4), torch.full((3,), 1, dtype=torch.int64))\n\n        try:\n            simulator.display()\n        except Exception:\n            pass\n\nsimulate()", "code_hash": "2d32b9793b2ac851c198f979ed881154", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dNNg", "name": "_"}], "metadata": {"marimo_version": "0.19.9"}, "version": "1"},
            "session": {"cells": [{"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8ead86caece2e18d877e58f1f6b3dfc6", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"distributed-tensors-in-monarch\"\u003EDistributed Tensors in Monarch\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EMonarch can broadcast tensor compute to a mesh of processes, allowing a single\ncontroller to do distributed tensor compute.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d541e3ffa6d179a99f56a9c9e99ec0e6", "console": [], "id": "vblA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "3012a77179fbdb1bd7e05395cdaee1b2", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"meshes\"\u003EMeshes\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EAll computation is done on a 'mesh' of devices.\nHere we create a mesh composed of the machine running the notebook:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f0fe41e36cb0b07f301684983b10c8c8", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "Monarch internal logs are being written to /tmp/allencwang/monarch_log.log; execution id allencwang_Feb-07_10:55_517\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "                                           gpu                                           \n+----------+----------+----------+----------+----------+----------+----------+----------+\n|        0 |        1 |        2 |        3 |        4 |        5 |        6 |        7 |\n+==========+==========+==========+==========+==========+==========+==========+==========+\n| 0.gpu[0] | 1.gpu[0] | 2.gpu[0] | 3.gpu[0] | 4.gpu[0] | 5.gpu[0] | 6.gpu[0] | 7.gpu[0] |\n+----------+----------+----------+----------+----------+----------+----------+----------+\n", "type": "stream"}], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "91661160d49578481a5334876da42e94", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWithout a mesh active, torch runs locally.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "72c528bae826df2239243aca7f068997", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Etensor([[0.7976, 0.0722, 0.6154, 0.5150],\n        [0.2588, 0.8020, 0.1901, 0.9124],\n        [0.7380, 0.9411, 0.3941, 0.7332]], device=\u0026#x27;cuda:0\u0026#x27;)\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "0f25a61710bde87208074dbd5096d93d", "console": [], "id": "SFPL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EOnce active, torch runs on every device in the mesh.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "efa24e9e15b30ba5057cef1653c75c10", "console": [], "id": "BYtC", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Emonarch.Tensor(mesh=\u0026lt;DeviceMesh(names((\u0026#x27;gpu\u0026#x27;,)), processes([0, 1, 2, 3, 4, 5, 6, 7])) at 0x7f4728616960\u0026gt;, stream=stream \u0026#x27;main\u0026#x27;, fake=FakeTensor(..., device=\u0026#x27;cuda:0\u0026#x27;, size=(3, 4)))\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "a91a5a352b0a334c8f9385ce871e341a", "console": [], "id": "RGSE", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E\u003Ccode\u003Einspect\u003C/code\u003E moves rank 0's copy of \u003Ccode\u003Et\u003C/code\u003E to the notebook for debugging.\nProviding coordinates lets us inspect other ranks' copies.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "9703181d0bb0ead7af3d515b8a75406d", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "sys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\n", "type": "stream"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGj5JREFUeJzt2rGNAkEQRcHjhEMUZICJRQAbI4SDQzhY686lsLq3aIRUFUDr2099GGOMHwAAAADgX35nDwAAAACAbyawAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQHDc++D9ft/7JMBHnM/n2RMANlmWZfYEgE1ut9vsCQCbPJ/PXe/5YAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACA4Lj3wdPptPdJgI+4Xq+zJwBssq7r7AkAm7xer9kTAKbwwQYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAMFx74Pv93vvkwAf8Xg8Zk8A2ORyucyeALDJsiyzJwBM4YMNAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAgsMYY8weAQAAAADfygcbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAR/kZMhTx1S8Z0AAAAASUVORK5CYII=\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGkdJREFUeJzt2kGNAlEURcHpCcEQAlCAibaAJ5bYQAdbVjj4Y6Ezp8kPSZWAl7s+ecsYY/wAAAAAAP/yO3sAAAAAAHwzgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAAACgQ0AAAAAAoENAAAAAAKBDQAAAACCw94Hl2XZ+yTAR5zP59kTADa5XC6zJwBscr1eZ08AmMIHGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEyxhj7Hnw8XjseQ7gY97v9+wJAJscj8fZEwA2eT6fsycAbLKu6673fLABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEBw2Pvg6/Xa+yTAR9zv99kTADa53W6zJwBscjqdZk8A2GRd113v+WADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAYBljjNkjAAAAAOBb+WADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgOAP43Mnx8gcBJMAAAAASUVORK5CYII=\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}], "id": "Kclp", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "fcffb5dcbee2fe1fe34cba6a57265e98", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"tensor-commands\"\u003ETensor Commands\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EAny command done on the controller, such as multiplying these tensors,\nperforms that action to all of the tensors in the collection.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "36566cf6a12e7ef850c4166b0c61b88d", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/torchshow/visualization.py:385: UserWarning: Original input range is not 0-1 when using grayscale mode. Auto-rescaling it to 0-1 by default.\n  warnings.warn('Original input range is not 0-1 when using grayscale mode. Auto-rescaling it to 0-1 by default.')\n", "type": "stream"}, {"data": "{\"image/png\": \"data:image/png;base64,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\", \"__metadata__\": {\"image/png\": {\"width\": 469, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cc549c8cf3c683ff986aa74185136386", "console": [], "id": "nWHF", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EIf a command fails, the workers stay alive and can execute future commands:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d721b5caf6fc0bf1e6512ce258771c44", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "Traceback (most recent call last):\n  File \"/tmp/marimo_2374276/__marimo__cell_iLit_.py\", line 5, in \u003Cmodule\u003E\n    monarch.show(v)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/fetch.py\", line 42, in show\n    v = inspect(obj, shard=shard, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/fetch.py\", line 51, in inspect\n    return fetch_shard(obj, shard=shard, **kwargs).result()\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/future.py\", line 193, in result\n    return self.get(timeout)\n           ^^^^^^^^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/future.py\", line 117, in get\n    raise e from None\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/future.py\", line 112, in get\n    v = coro.block_on()\n        ^^^^^^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/endpoint.py\", line 83, in _wrapper\n    return await coro\n           ^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/endpoint.py\", line 263, in process\n    result = await r.recv()\n             ^^^^^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/actor_mesh.py\", line 1177, in _recv\n    return self._process(result)\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/actor_mesh.py\", line 1188, in _process\n    raise e\nmonarch.mesh_controller.RemoteException: A remote function has failed asynchronously on rank 0.\nTraceback of where the remote function was issued on controller (most recent call last):\n  File \"/home/allencwang/monarch-gpu-mode/.venv/bin/marimo\", line 10, in \u003Cmodule\u003E\n    sys.exit(main())\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/click/core.py\", line 1485, in __call__\n    return self.main(*args, **kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/click/core.py\", line 1406, in main\n    rv = self.invoke(ctx)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/click/core.py\", line 1873, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/click/core.py\", line 1873, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/click/core.py\", line 1269, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/click/core.py\", line 824, in invoke\n    return callback(*args, **kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_cli/export/commands.py\", line 239, in html\n    return watch_and_export(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_cli/export/commands.py\", line 89, in watch_and_export\n    result = export_callback(marimo_path)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_cli/export/commands.py\", line 230, in export_callback\n    return asyncio_run(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_server/utils.py\", line 78, in asyncio_run\n    return asyncio.run(coro, **kwargs)  # type: ignore[arg-type]\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py\", line 195, in run\n    return runner.run(main)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py\", line 678, in run_until_complete\n    self.run_forever()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py\", line 645, in run_forever\n    self._run_once()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py\", line 1999, in _run_once\n    handle._run()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_server/export/__init__.py\", line 262, in run_app_then_export_as_html\n    session_view, did_error = await run_app_until_completion(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_server/export/__init__.py\", line 443, in run_app_until_completion\n    session = SessionImpl.create(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_session/session.py\", line 159, in create\n    return cls(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_session/session.py\", line 194, in __init__\n    self._kernel_manager.start_kernel()\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_session/managers/kernel.py\", line 147, in start_kernel\n    self.kernel_task.start()  # type: ignore\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/process.py\", line 121, in start\n    self._popen = self._Popen(self)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/context.py\", line 224, in _Popen\n    return _default_context.get_context().Process._Popen(process_obj)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/context.py\", line 282, in _Popen\n    return Popen(process_obj)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/popen_fork.py\", line 19, in __init__\n    self._launch(process_obj)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/popen_fork.py\", line 71, in _launch\n    code = process_obj._bootstrap(parent_sentinel=child_r)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/process.py\", line 314, in _bootstrap\n    self.run()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/multiprocessing/process.py\", line 108, in run\n    self._target(*self._args, **self._kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 3345, in launch_kernel\n    asyncio.run(control_loop(kernel))\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py\", line 195, in run\n    return runner.run(main)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py\", line 678, in run_until_complete\n    self.run_forever()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py\", line 645, in run_forever\n    self._run_once()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/base_events.py\", line 1999, in _run_once\n    handle._run()\n  File \"/home/allencwang/.local/share/uv/python/cpython-3.12.12-linux-x86_64-gnu/lib/python3.12/asyncio/events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 3339, in control_loop\n    await kernel.handle_message(request)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 2382, in handle_message\n    await self.request_handler.handle(request)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 3141, in handle\n    return await handler(request)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 2231, in handle_instantiate\n    await self.instantiate(request)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 2128, in instantiate\n    await self.run(list(execution_requests.values()))\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 1658, in run\n    await _run_with_uninstantiated_requests(execution_requests)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 1598, in _run_with_uninstantiated_requests\n    await self._run_cells(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 1393, in _run_cells\n    while cell_ids := await self._run_cells_internal(cell_ids):\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runtime.py\", line 1478, in _run_cells_internal\n    await runner.run_all()\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runner/cell_runner.py\", line 709, in run_all\n    run_result = await self.run(cell_id)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/runner/cell_runner.py\", line 492, in run\n    return_value = self._executor.execute_cell(\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/marimo/_runtime/executor.py\", line 138, in execute_cell\n    exec(cell.body, glbls)\n  File \"/tmp/marimo_2374276/__marimo__cell_iLit_.py\", line 3, in \u003Cmodule\u003E\n    big_w = torch.rand(4, 1024 * 1024 * 1024 * 1024 * 8, device=\"cuda\")\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/torch/utils/_device.py\", line 109, in __torch_function__\n    return func(*args, **kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/common/device_mesh.py\", line 342, in __torch_dispatch__\n    return _remote(func, propagate=func)(*args, **kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/common/remote.py\", line 152, in __call__\n    return self.rref(*args, **kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/_src/actor/endpoint.py\", line 372, in rref\n    return self._rref(args, kwargs)\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/monarch/common/remote.py\", line 142, in _rref\n    return dtensor_dispatch(\nError as reported from worker:\nTraceback (most recent call last):\n  File \"/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/torch/_ops.py\", line 819, in __call__\n    return self._op(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\ntorch.OutOfMemoryError: CUDA out of memory. Tried to allocate 131072.00 GiB. GPU 0 has a total capacity of 95.07 GiB of which 30.36 GiB is free. Process 16987 has 538.00 MiB memory in use. Process 2630330 has 1.24 GiB memory in use. Process 2632699 has 3.45 GiB memory in use. Process 3162211 has 5.30 GiB memory in use. Process 3162281 has 620.00 MiB memory in use. Process 3162224 has 624.00 MiB memory in use. Process 3162296 has 3.57 GiB memory in use. Process 3162355 has 1.98 GiB memory in use. Process 3162860 has 3.44 GiB memory in use. Process 3163207 has 16.84 GiB memory in use. Process 3164277 has 12.58 GiB memory in use. Process 3163913 has 624.00 MiB memory in use. Process 3164353 has 3.45 GiB memory in use. Process 894204 has 9.20 GiB memory in use. Process 2374276 has 616.00 MiB memory in use. Including non-PyTorch memory, this process has 620.00 MiB memory in use. Of the allocated memory 32.00 MiB is allocated by PyTorch, and 2.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)\n\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stdout", "text": "RECOVERED!\n", "type": "stream"}], "id": "iLit", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "53a2585a17fdad241e934ceb8a92a0ac", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ESince monarch recovers from errors, you can search for what works:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "176adf2396ef926460999029fabe70e3", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "at least 2**2 elements work\nat least 2**4 elements work\nat least 2**8 elements work\nmax is 2**8 elements\n", "type": "stream"}], "id": "ROlb", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1cc424a5f3a12ead4fd8e9a71f538248", "console": [], "id": "qnkX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"collectives\"\u003ECollectives\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EEach machine has its own copy of the tensor, similar to \u003Ccode\u003Etorch.distributed\u003C/code\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ETo compute across tensors in the mesh, we use special communication operators,\nanalogous to collectives.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a50d5ba6cef8f0ac36c8d71012f8b5da", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "INFO:monarch.common.client:[actor=\u003Croot\u003E] Initializing backend network\n", "type": "stream"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGkBJREFUeJzt2kGNAlEURcFhwhYXWEAfQjCABwIy2JAWgIo/FjpzmvyQVAl4ueuTtxtjjB8AAAAA4F9+Zw8AAAAAgG8msAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAEAgsAEAAABAILABAAAAQCCwAQAAAECw3/rg4/HY+iTAR1yv19kTAFZ5Pp+zJwCs8n6/Z08AWOX1em16zwcbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAT7rQ8eDoetTwJ8xOVymT0BYJXz+Tx7AsAqy7LMngAwhQ82AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAI9lsfPJ1OW58E+Ij7/T57AsAqx+Nx9gSAVW632+wJAFP4YAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBgN8YYs0cAAAAAwLfywQYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAgcAGAAAAAIHABgAAAACBwAYAAAAAwR/H4SbUMuXaqQAAAABJRU5ErkJggg==\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGkhJREFUeJzt2kGNAlEURcFhwAMyWGGDNWu0YAM5LQIJJHj4Y6Ezp8kPSZWAl7s+ebsxxvgBAAAAAP7ld/YAAAAAAPhmAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEh60Pvl6vrU8CfMTxeJw9AWCV5/M5ewLAKsuyzJ4AsMrtdtv0ng82AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAh2Y4yx5cH7/b7lOYCP2e/3sycArHK9XmdPAFjlfD7PngCwyvv93vSeDzYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgOWx88nU5bnwT4iMvlMnsCwCrLssyeALDK4/GYPQFgCh9sAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEOzGGGP2CAAAAAD4Vj7YAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACD4A0VhJ+tvoMbAAAAAAElFTkSuQmCC\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}, {"mimetype": "text/plain", "name": "stderr", "text": "/home/allencwang/monarch-gpu-mode/.venv/lib/python3.12/site-packages/torchshow/visualization.py:385: UserWarning: Original input range is not 0-1 when using grayscale mode. Auto-rescaling it to 0-1 by default.\n  warnings.warn('Original input range is not 0-1 when using grayscale mode. Auto-rescaling it to 0-1 by default.')\n", "type": "stream"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGj5JREFUeJzt2rGNQkEQBcHjRBAYpICJRajYmGRCEgSBgbWXwur6oxVSVQCjZ7dmN8YYPwAAAADAv/yuHgAAAAAA30xgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgGC/egDAKufzefUEgCmXy2X1BIApr9dr9QSAKdfrddN7PtgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAINhvffD5fG59EuAjjsfj6gkAU+73++oJAFMej8fqCQBL+GADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBgv/XB2+229UmAj3i/36snAEw5nU6rJwBMORwOqycATBljbHrPBxsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEuzHGWD0CAAAAAL6VDzYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACP4AXUolXVW6vaYAAAAASUVORK5CYII=\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGj5JREFUeJzt2rGNQkEQBcHjRBAYpICJRajYmGRCEgSBgbWXwur6oxVSVQCjZ7dmN8YYPwAAAADAv/yuHgAAAAAA30xgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgGC/egDAKufzefUEgCmXy2X1BIApr9dr9QSAKdfrddN7PtgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAINhvffD5fG59EuAjjsfj6gkAU+73++oJAFMej8fqCQBL+GADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBgv/XB2+229UmAj3i/36snAEw5nU6rJwBMORwOqycATBljbHrPBxsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEuzHGWD0CAAAAAL6VDzYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACP4AXUolXVW6vaYAAAAASUVORK5CYII=\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}], "id": "TqIu", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ca856f2f5ee511823b8ae678cd2cad50", "console": [], "id": "Vxnm", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"remote-gpus\"\u003ERemote GPUs\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can also connect to remote GPUs reserved from some scheduler.\nHere we simulate a multi-host setup locally:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "af97a927435bd43bf5ce926c57f42b8e", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "                                  gpu                       \n     \u2502+----+-----------+-----------+-----------+-----------+\n     \u2502|    |         0 |         1 |         2 |         3 |\n     \u2502+====+===========+===========+===========+===========+\n     \u2502|  0 |  0.gpu[0] |  1.gpu[0] |  2.gpu[0] |  3.gpu[0] |\n     \u2502+----+-----------+-----------+-----------+-----------+\nhost \u2502|  1 |  4.gpu[0] |  5.gpu[0] |  6.gpu[0] |  7.gpu[0] |\n     \u2502+----+-----------+-----------+-----------+-----------+\n     \u2502|  2 |  8.gpu[0] |  9.gpu[0] | 10.gpu[0] | 11.gpu[0] |\n     \u2502+----+-----------+-----------+-----------+-----------+\n     \u2502|  3 | 12.gpu[0] | 13.gpu[0] | 14.gpu[0] | 15.gpu[0] |\n     \u2502+----+-----------+-----------+-----------+-----------+\n", "type": "stream"}, {"mimetype": "text/plain", "name": "stderr", "text": "INFO:monarch.common.client:[actor=\u003Croot\u003E] Initializing backend network\n", "type": "stream"}], "id": "DnEU", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "221d093b3b0728ace466889809bd5903", "console": [], "id": "ulZA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"device-mesh-dimensions\"\u003EDevice Mesh Dimensions\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EMeshes can be renamed and reshaped to fit the parallelism desired.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f4e5b8f0fec008a9c38a8d16ce6ab461", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "                                tp                        \n   \u2502+----+-----------+-----------+-----------+-----------+\n   \u2502|    |         0 |         1 |         2 |         3 |\n   \u2502+====+===========+===========+===========+===========+\n   \u2502|  0 |  0.gpu[0] |  1.gpu[0] |  2.gpu[0] |  3.gpu[0] |\n   \u2502+----+-----------+-----------+-----------+-----------+\ndp \u2502|  1 |  4.gpu[0] |  5.gpu[0] |  6.gpu[0] |  7.gpu[0] |\n   \u2502+----+-----------+-----------+-----------+-----------+\n   \u2502|  2 |  8.gpu[0] |  9.gpu[0] | 10.gpu[0] | 11.gpu[0] |\n   \u2502+----+-----------+-----------+-----------+-----------+\n   \u2502|  3 | 12.gpu[0] | 13.gpu[0] | 14.gpu[0] | 15.gpu[0] |\n   \u2502+----+-----------+-----------+-----------+-----------+\ndp: 0\n                              tp                      \n   \u2502+----+----------+----------+----------+----------+\n   \u2502|    |        0 |        1 |        2 |        3 |\n   \u2502+====+==========+==========+==========+==========+\npp \u2502|  0 | 0.gpu[0] | 1.gpu[0] | 2.gpu[0] | 3.gpu[0] |\n   \u2502+----+----------+----------+----------+----------+\n   \u2502|  1 | 4.gpu[0] | 5.gpu[0] | 6.gpu[0] | 7.gpu[0] |\n   \u2502+----+----------+----------+----------+----------+\n\ndp: 1\n   \u2502+----+-----------+-----------+-----------+-----------+\n   \u2502|    |         0 |         1 |         2 |         3 |\n   \u2502+====+===========+===========+===========+===========+\npp \u2502|  0 |  8.gpu[0] |  9.gpu[0] | 10.gpu[0] | 11.gpu[0] |\n   \u2502+----+-----------+-----------+-----------+-----------+\n   \u2502|  1 | 12.gpu[0] | 13.gpu[0] | 14.gpu[0] | 15.gpu[0] |\n   \u2502+----+-----------+-----------+-----------+-----------+\n", "type": "stream"}], "id": "ecfG", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "06909103b6e9c76199caffc3f4910921", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"pipelining\"\u003EPipelining\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EPipelining is accomplished by slicing the mesh, and copying tensors from\none mesh to another.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "7d49cade3de6e2dfc6502ba520d0cadd", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "                     gpu                     \n+----------+----------+----------+----------+\n|        0 |        1 |        2 |        3 |\n+==========+==========+==========+==========+\n| 0.gpu[0] | 1.gpu[0] | 2.gpu[0] | 3.gpu[0] |\n+----------+----------+----------+----------+\n", "type": "stream"}], "id": "ZBYS", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "4478979a0208e4c0c82e64dca71e03be", "console": [], "id": "aLJB", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EInitialize a model across multiple pipeline stages:\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "97c39cdf4f6a0851ad32cbbf8b4e1801", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "sys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\nsys:1: FutureWarning: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.\n", "type": "stream"}, {"data": "{\"image/png\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABNgAAAOsCAYAAACYogslAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjgsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvwVt1zgAAAAlwSFlzAAAewgAAHsIBbtB1PgAAGfhJREFUeJzt2sEJw0AQBEGfcfh6Kj+Fsk5BuA2HoCqAZd7NrpmZFwAAAADwk/fuAQAAAADwZAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABAIbAAAAAAQCGwAAAAAEAhsAAAAABJ/dAwB2WWvtngBwy3VduycA3HKe5+4JALccx/HXez7YAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgENgAAAAAIBDYAAAAACAQ2AAAAAAgWDMzu0cAAAAAwFP5YAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACAQGADAAAAgEBgAwAAAIBAYAMAAACA4AtoxRVRXKNYkQAAAABJRU5ErkJggg==\", \"__metadata__\": {\"image/png\": {\"width\": 620, \"height\": 470}}}", "mimetype": "application/vnd.marimo+mimebundle", "name": "media", "type": "streamMedia"}, {"mimetype": "text/plain", "name": "stdout", "text": "                       gpu                       \n+-----------+-----------+-----------+-----------+\n|         0 |         1 |         2 |         3 |\n+===========+===========+===========+===========+\n| 12.gpu[0] | 13.gpu[0] | 14.gpu[0] | 15.gpu[0] |\n+-----------+-----------+-----------+-----------+\n", "type": "stream"}], "id": "nHfw", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c7424d07b8789ab496b972e5bb8f24c8", "console": [], "id": "xXTn", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"ddp-example\"\u003EDDP Example\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThe next sections use an example of writing DDP to illustrate a typical way to\ndevelop code in Monarch.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe interleave the backward pass with the gradient reductions and parameter updates.\n\u003Ccode\u003Emonarch.grad_generator\u003C/code\u003E incrementally runs the backward pass, returning an iterator\nthat computes the grad parameters one at a time.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "812b78f0d4ed08eee1f7d86cdcfd1077", "console": [], "id": "AjVT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "43c829a81ec2f100f41455f7eca01171", "console": [], "id": "pHFh", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"simulation\"\u003ESimulation\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EWe can use a simulator to check for expected behavior of code before running it\nfor real. It is another kind of mesh, which simulates rather than computes results.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "787fa7e9ae5a7dfa2db755f3ce7d2472", "console": [], "id": "NCOB", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"overlapping-commscompute\"\u003EOverlapping Comms/Compute\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ECommands on different devices run in parallel, but by default commands on a single\ndevice run sequentially.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWe introduce parallelism on a device via stream objects. To use a tensor from one\nstream on another we borrow it. The borrow API ensures deterministic memory usage\nand eliminates the race conditions in the \u003Ccode\u003Etorch.cuda.stream\u003C/code\u003E API.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "378f76c1b006c37d46b675347c38c3b4", "console": [], "id": "aqbW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2ee3b3b50e459c2bfccabb45066464f9", "console": [], "id": "TRpd", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe DDP example again, but using multiple streams:\u003C/span\u003E\n\u003Chr /\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EPrevious:\u003C/strong\u003E \u003Ca href=\"./03_fault_tolerance.html\"\u003ENB03 \u2014 Fault Tolerance\u003C/a\u003E \u00b7 \u003Cstrong\u003ENext:\u003C/strong\u003E \u003Ca href=\"./05_rl_intro.html\"\u003ENB05 \u2014 RL Intro\u003C/a\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2d32b9793b2ac851c198f979ed881154", "console": [{"mimetype": "text/plain", "name": "stderr", "text": "INFO:monarch.common.client:[actor=\u003Croot\u003E] Initializing backend network\n/home/allencwang/.local/bin/trace2html: line 2: /home/allencwang/forge-dev/smol_projects/monarch-gpu-mode/.venv/bin/python: No such file or directory\n", "type": "stream"}], "id": "TXez", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "dNNg", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.9"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.19.9%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Distributed%20Tensors%20in%20Monarch%0A%0A%20%20%20%20Monarch%20can%20broadcast%20tensor%20compute%20to%20a%20mesh%20of%20processes%2C%20allowing%20a%20single%0A%20%20%20%20controller%20to%20do%20distributed%20tensor%20compute.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20monarch%0A%20%20%20%20import%20torch%0A%20%20%20%20import%20torch.nn%20as%20nn%0A%20%20%20%20from%20monarch.actor%20import%20this_host%0A%0A%20%20%20%20torch.set_default_device(%22cuda%22)%0A%20%20%20%20return%20monarch%2C%20nn%2C%20this_host%2C%20torch%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Meshes%0A%0A%20%20%20%20All%20computation%20is%20done%20on%20a%20'mesh'%20of%20devices.%0A%20%20%20%20Here%20we%20create%20a%20mesh%20composed%20of%20the%20machine%20running%20the%20notebook%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(this_host)%3A%0A%20%20%20%20mesh%20%3D%20this_host().spawn_procs(%7B%22gpu%22%3A%208%7D)%0A%20%20%20%20print(mesh.to_table())%0A%20%20%20%20return%20(mesh%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Without%20a%20mesh%20active%2C%20torch%20runs%20locally.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(torch)%3A%0A%20%20%20%20torch.rand(3%2C%204)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Once%20active%2C%20torch%20runs%20on%20every%20device%20in%20the%20mesh.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mesh%2C%20torch)%3A%0A%20%20%20%20with%20mesh.activate()%3A%0A%20%20%20%20%20%20%20%20t%20%3D%20torch.rand(3%2C%204%2C%20device%3D%22cuda%22)%0A%20%20%20%20t%0A%20%20%20%20return%20(t%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%60inspect%60%20moves%20rank%200's%20copy%20of%20%60t%60%20to%20the%20notebook%20for%20debugging.%0A%20%20%20%20Providing%20coordinates%20lets%20us%20inspect%20other%20ranks'%20copies.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(monarch%2C%20t)%3A%0A%20%20%20%20monarch.inspect(t)%0A%20%20%20%20monarch.show(t)%0A%20%20%20%20monarch.show(t%2C%20gpu%3D1)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Tensor%20Commands%0A%0A%20%20%20%20Any%20command%20done%20on%20the%20controller%2C%20such%20as%20multiplying%20these%20tensors%2C%0A%20%20%20%20performs%20that%20action%20to%20all%20of%20the%20tensors%20in%20the%20collection.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mesh%2C%20monarch%2C%20t)%3A%0A%20%20%20%20with%20mesh.activate()%3A%0A%20%20%20%20%20%20%20%20obj%20%3D%20t%20%40%20t.T%0A%20%20%20%20%20%20%20%20monarch.show(obj)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20If%20a%20command%20fails%2C%20the%20workers%20stay%20alive%20and%20can%20execute%20future%20commands%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mesh%2C%20monarch%2C%20t%2C%20torch)%3A%0A%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20with%20mesh.activate()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20big_w%20%3D%20torch.rand(4%2C%201024%20*%201024%20*%201024%20*%201024%20*%208%2C%20device%3D%22cuda%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20v%20%3D%20t%20%40%20big_w%0A%20%20%20%20%20%20%20%20%20%20%20%20monarch.show(v)%0A%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20import%20traceback%0A%20%20%20%20%20%20%20%20traceback.print_exc()%0A%0A%20%20%20%20print(%22RECOVERED!%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Since%20monarch%20recovers%20from%20errors%2C%20you%20can%20search%20for%20what%20works%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mesh%2C%20monarch%2C%20torch)%3A%0A%20%20%20%20N%20%3D%201%0A%20%20%20%20while%20True%3A%0A%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20with%20mesh.activate()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20batch%20%3D%20torch.rand(N%2C%201024%20*%201024%20*%201024%2C%20device%3D%22cuda%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20monarch.inspect(batch.sum())%0A%20%20%20%20%20%20%20%20%20%20%20%20N%20%3D%202%20*%20N%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22at%20least%202**%7BN%7D%20elements%20work%22)%0A%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22max%20is%202**%7BN%7D%20elements%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20break%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Collectives%0A%0A%20%20%20%20Each%20machine%20has%20its%20own%20copy%20of%20the%20tensor%2C%20similar%20to%20%60torch.distributed%60.%0A%0A%20%20%20%20To%20compute%20across%20tensors%20in%20the%20mesh%2C%20we%20use%20special%20communication%20operators%2C%0A%20%20%20%20analogous%20to%20collectives.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mesh%2C%20monarch%2C%20torch)%3A%0A%20%20%20%20with%20mesh.activate()%3A%0A%20%20%20%20%20%20%20%20a%20%3D%20torch.rand(3%2C%204%2C%20device%3D%22cuda%22)%0A%20%20%20%20%20%20%20%20r%20%3D%20a.reduce(%22gpu%22%2C%20%22sum%22)%0A%0A%20%20%20%20monarch.show(a%2C%20gpu%3D0)%0A%20%20%20%20monarch.show(a%2C%20gpu%3D1)%0A%0A%20%20%20%20monarch.show(r%2C%20gpu%3D0)%0A%20%20%20%20monarch.show(r%2C%20gpu%3D1)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Remote%20GPUs%0A%0A%20%20%20%20We%20can%20also%20connect%20to%20remote%20GPUs%20reserved%20from%20some%20scheduler.%0A%20%20%20%20Here%20we%20simulate%20a%20multi-host%20setup%20locally%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(this_host%2C%20torch)%3A%0A%20%20%20%20remote_mesh%20%3D%20this_host().spawn_procs(%7B%22host%22%3A%204%2C%20%22gpu%22%3A%204%7D)%0A%0A%20%20%20%20print(remote_mesh.to_table())%0A%20%20%20%20with%20remote_mesh.activate()%3A%0A%20%20%20%20%20%20%20%20eg%20%3D%20torch.rand(3%2C%204%2C%20device%3D%22cuda%22)%0A%20%20%20%20%20%20%20%20rgpu%20%3D%20eg.reduce(%22gpu%22%2C%20%22sum%22)%0A%20%20%20%20%20%20%20%20rhost%20%3D%20eg.reduce(%22host%22%2C%20%22sum%22)%0A%20%20%20%20return%20(remote_mesh%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Device%20Mesh%20Dimensions%0A%0A%20%20%20%20Meshes%20can%20be%20renamed%20and%20reshaped%20to%20fit%20the%20parallelism%20desired.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(remote_mesh)%3A%0A%20%20%20%20mesh_2d_parallel%20%3D%20remote_mesh.rename(host%3D%22dp%22%2C%20gpu%3D%22tp%22)%0A%20%20%20%20print(mesh_2d_parallel.to_table())%0A%0A%20%20%20%20mesh_3d_parallel%20%3D%20remote_mesh.split(host%3D(%22dp%22%2C%20%22pp%22)%2C%20gpu%3D(%22tp%22%2C)%2C%20pp%3D2)%0A%20%20%20%20print(mesh_3d_parallel.to_table())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Pipelining%0A%0A%20%20%20%20Pipelining%20is%20accomplished%20by%20slicing%20the%20mesh%2C%20and%20copying%20tensors%20from%0A%20%20%20%20one%20mesh%20to%20another.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(remote_mesh)%3A%0A%20%20%20%20pipeline_mesh%20%3D%20remote_mesh.rename(host%3D%22pp%22)%0A%20%20%20%20meshes%20%3D%20%5Bpipeline_mesh.slice(pp%3Di)%20for%20i%20in%20range(pipeline_mesh.size(%22pp%22))%5D%0A%20%20%20%20print(meshes%5B0%5D.to_table())%0A%20%20%20%20return%20(meshes%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Initialize%20a%20model%20across%20multiple%20pipeline%20stages%3A%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(meshes%2C%20monarch%2C%20nn%2C%20torch)%3A%0A%20%20%20%20layers_per_stage%20%3D%202%0A%20%20%20%20stages%20%3D%20%5B%5D%0A%20%20%20%20for%20stage_mesh%20in%20meshes%3A%0A%20%20%20%20%20%20%20%20with%20stage_mesh.activate()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20layers%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20_%20in%20range(layers_per_stage)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layers.extend(%5Bnn.Linear(4%2C%204)%2C%20nn.ReLU()%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20stages.append(nn.Sequential(*layers))%0A%0A%20%20%20%20def%20forward_pipeline(x)%3A%0A%20%20%20%20%20%20%20%20with%20torch.no_grad()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20stage_mesh%2C%20stage%20in%20zip(meshes%2C%20stages)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20x.to_mesh(stage_mesh)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20with%20stage_mesh.activate()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%20%3D%20stage(x)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20x%0A%0A%20%20%20%20with%20meshes%5B0%5D.activate()%3A%0A%20%20%20%20%20%20%20%20input%20%3D%20torch.rand(3%2C%204%2C%20device%3D%22cuda%22)%0A%0A%20%20%20%20output%20%3D%20forward_pipeline(input)%0A%20%20%20%20monarch.show(output)%0A%20%20%20%20print(output.mesh.to_table())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20DDP%20Example%0A%0A%20%20%20%20The%20next%20sections%20use%20an%20example%20of%20writing%20DDP%20to%20illustrate%20a%20typical%20way%20to%0A%20%20%20%20develop%20code%20in%20Monarch.%0A%0A%20%20%20%20We%20interleave%20the%20backward%20pass%20with%20the%20gradient%20reductions%20and%20parameter%20updates.%0A%20%20%20%20%60monarch.grad_generator%60%20incrementally%20runs%20the%20backward%20pass%2C%20returning%20an%20iterator%0A%20%20%20%20that%20computes%20the%20grad%20parameters%20one%20at%20a%20time.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(monarch%2C%20torch)%3A%0A%20%20%20%20def%20train(model%2C%20input%2C%20target)%3A%0A%20%20%20%20%20%20%20%20loss%20%3D%20model(input%2C%20target)%0A%20%20%20%20%20%20%20%20rparameters%20%3D%20list(reversed(list(model.parameters())))%0A%20%20%20%20%20%20%20%20grads%20%3D%20monarch.grad_generator(loss%2C%20rparameters)%0A%20%20%20%20%20%20%20%20with%20torch.no_grad()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20it%20%3D%20iter(zip(rparameters%2C%20grads))%0A%20%20%20%20%20%20%20%20%20%20%20%20todo%20%3D%20next(it%2C%20None)%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20todo%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20param%2C%20grad%20%3D%20todo%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20grad.reduce_(%22dp%22%2C%20%22sum%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20todo%20%3D%20next(it%2C%20None)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20param%20%2B%3D%200.01%20*%20grad%0A%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Simulation%0A%0A%20%20%20%20We%20can%20use%20a%20simulator%20to%20check%20for%20expected%20behavior%20of%20code%20before%20running%20it%0A%20%20%20%20for%20real.%20It%20is%20another%20kind%20of%20mesh%2C%20which%20simulates%20rather%20than%20computes%20results.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Overlapping%20Comms%2FCompute%0A%0A%20%20%20%20Commands%20on%20different%20devices%20run%20in%20parallel%2C%20but%20by%20default%20commands%20on%20a%20single%0A%20%20%20%20device%20run%20sequentially.%0A%0A%20%20%20%20We%20introduce%20parallelism%20on%20a%20device%20via%20stream%20objects.%20To%20use%20a%20tensor%20from%20one%0A%20%20%20%20stream%20on%20another%20we%20borrow%20it.%20The%20borrow%20API%20ensures%20deterministic%20memory%20usage%0A%20%20%20%20and%20eliminates%20the%20race%20conditions%20in%20the%20%60torch.cuda.stream%60%20API.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(monarch)%3A%0A%20%20%20%20main%20%3D%20monarch.get_active_stream()%0A%20%20%20%20comms%20%3D%20monarch.Stream(%22comms%22)%0A%20%20%20%20return%20(comms%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20DDP%20example%20again%2C%20but%20using%20multiple%20streams%3A%0A%0A%20%20%20%20---%0A%0A%20%20%20%20**Previous%3A**%20%5BNB03%20%E2%80%94%20Fault%20Tolerance%5D(.%2F03_fault_tolerance.html)%20%C2%B7%20**Next%3A**%20%5BNB05%20%E2%80%94%20RL%20Intro%5D(.%2F05_rl_intro.html)%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(comms%2C%20monarch%2C%20nn%2C%20torch)%3A%0A%20%20%20%20class%20Net(nn.Module)%3A%0A%20%20%20%20%20%20%20%20def%20__init__(self)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20super().__init__()%0A%20%20%20%20%20%20%20%20%20%20%20%20layers%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20x%20in%20range(8)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layers.append(nn.Linear(4%2C%204))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20layers.append(nn.ReLU())%0A%20%20%20%20%20%20%20%20%20%20%20%20self.layers%20%3D%20nn.Sequential(*layers)%0A%0A%20%20%20%20%20%20%20%20def%20forward(self%2C%20input%2C%20target)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20output%20%3D%20self.layers(input)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20torch.nn.functional.cross_entropy(output%2C%20target)%0A%0A%20%20%20%20def%20train2(model%2C%20input%2C%20target)%3A%0A%20%20%20%20%20%20%20%20loss%20%3D%20model(input%2C%20target)%0A%20%20%20%20%20%20%20%20rparameters%20%3D%20list(reversed(list(model.parameters())))%0A%20%20%20%20%20%20%20%20grads%20%3D%20monarch.grad_generator(loss%2C%20rparameters)%0A%20%20%20%20%20%20%20%20with%20torch.no_grad()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20NEW%3A%20iter%20also%20produces%20the%20tensor%20borrowed%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20to%20the%20comm%20stream%0A%20%20%20%20%20%20%20%20%20%20%20%20it%20%3D%20iter(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(param%2C%20grad%2C%20*comms.borrow(grad%2C%20mutable%3DTrue))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20for%20param%2C%20grad%20in%20zip(rparameters%2C%20grads)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20todo%20%3D%20next(it%2C%20None)%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20todo%20is%20not%20None%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20param%2C%20grad%2C%20comm_grad%2C%20borrow%20%3D%20todo%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20NEW%3A%20compute%20the%20reduce%20on%20the%20comm%20stream%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20with%20comms.activate()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20comm_grad.reduce_(%22dp%22%2C%20%22sum%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20borrow.drop()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20todo%20%3D%20next(it%2C%20None)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20param%20%2B%3D%200.01%20*%20grad%0A%0A%0A%0A%20%20%20%20def%20simulate()%3A%0A%20%20%20%20%20%20%20%20simulator%20%3D%20monarch.Simulator(hosts%3D1%2C%20gpus%3D4%2C%20trace_mode%3D%22stream_only%22)%0A%20%20%20%20%20%20%20%20mesh%20%3D%20simulator.mesh.rename(gpu%3D%22dp%22)%0A%20%20%20%20%20%20%20%20with%20mesh.activate()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20model%20%3D%20Net()%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20train2(model%2C%20torch.rand(3%2C%204)%2C%20torch.full((3%2C)%2C%201%2C%20dtype%3Dtorch.int64))%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20try%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20simulator.display()%0A%20%20%20%20%20%20%20%20%20%20%20%20except%20Exception%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20pass%0A%0A%20%20%20%20simulate()%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">c5b1b4bfcca9a2f8db220e12fca89a83</marimo-code-hash>
</body>
</html>
